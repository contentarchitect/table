!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@contentarchitect/editor")):"function"==typeof define&&define.amd?define(["@contentarchitect/editor"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).Table=e(t.ContentArchitect)}(this,(function(t){"use strict";var e={props:["value"],directives:{edit:t.EditDirective},data:()=>({captionSettings:{placeholder:"Table caption"}}),created(){this.value.data.forEach(t=>{t.id=Math.random()})},methods:{randomKey:()=>Math.random()},computed:{tbody(){return this.value.thead?this.value.data.slice(1,this.value.data.length):this.value.data}}};function n(t,e,n,a,r,o,s,i,l,c){"boolean"!=typeof s&&(l=i,i=s,s=!1);const d="function"==typeof n?n.options:n;let u;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,r&&(d.functional=!0)),a&&(d._scopeId=a),o?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},d._ssrRegister=u):e&&(u=s?function(t){e.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,i(t))}),u)if(d.functional){const t=d.render;d.render=function(e,n){return u.call(n),t(e,n)}}else{const t=d.beforeCreate;d.beforeCreate=t?[].concat(t,u):[u]}return n}const a="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function r(t){return(t,e)=>function(t,e){const n=a?e.media||"default":t,r=s[n]||(s[n]={ids:new Set,styles:[]});if(!r.ids.has(t)){r.ids.add(t);let n=e.source;if(e.map&&(n+="\n/*# sourceURL="+e.map.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),r.element||(r.element=document.createElement("style"),r.element.type="text/css",e.media&&r.element.setAttribute("media",e.media),void 0===o&&(o=document.head||document.getElementsByTagName("head")[0]),o.appendChild(r.element)),"styleSheet"in r.element)r.styles.push(n),r.element.styleSheet.cssText=r.styles.filter(Boolean).join("\n");else{const t=r.ids.size-1,e=document.createTextNode(n),a=r.element.childNodes;a[t]&&r.element.removeChild(a[t]),a.length?r.element.insertBefore(e,a[t]):r.element.appendChild(e)}}}(t,e)}let o;const s={};const i=e;var l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",[n("caption",{directives:[{name:"edit",rawName:"v-edit:[captionSettings]",value:t.value.caption,expression:"value.caption",arg:t.captionSettings}]}),t._v(" "),t.value.thead?n("thead",[n("tr",t._l(t.value.data[0],(function(e,a){return n("th",{directives:[{name:"edit",rawName:"v-edit.block.complex",value:{obj:t.value.data[0][a],exp:"value"},expression:"{ obj: value.data[0][i], exp: 'value' }",modifiers:{block:!0,complex:!0}}],key:a})})),0)]):t._e(),t._v(" "),n("tbody",t._l(t.tbody,(function(e,a){return n("tr",{key:e.id},t._l(e,(function(e,r){return n("td",{directives:[{name:"edit",rawName:"v-edit.block.complex",value:{obj:t.tbody[a][r],exp:"value"},expression:"{ obj: tbody[i][j], exp: 'value' }",modifiers:{block:!0,complex:!0}}],key:r})})),0)})),0)])};l._withStripped=!0;const c=n({render:l,staticRenderFns:[]},(function(t){t&&t("data-v-672ea060_0",{source:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",map:{version:3,sources:[],names:[],mappings:"",file:"view.vue"},media:void 0})}),i,undefined,false,undefined,!1,r,void 0,void 0);const d={components:{CssGrid:t.CssGrid,CaInput:t.CaInput,"v-button":t.Button},props:["value"],data:()=>({emptyCell:{value:""}}),computed:{rows(){return this.value.data.length},cols(){return this.value.data[0].length}},methods:{increaseColsCount(){this.value.data.forEach((t,e)=>{t.push({...this.emptyCell})})},decreaseColsCount(){this.value.data.forEach((t,e)=>t.pop())},increaseRowsCount(){const t=Array(this.cols).fill().map(()=>({...this.emptyCell}));t.id=Math.random(),this.value.data.push(t)},decreaseRowsCount(){this.value.data.pop()}}};var u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("css-grid",{attrs:{columns:["2fr","3fr"],gap:"8px 0"}},[n("label",{attrs:{for:""}},[t._v("Cols")]),t._v(" "),n("div",{staticClass:"table-control"},[n("v-button",{on:{click:t.decreaseColsCount}},[t._v("-")]),t._v(" "),n("span",[t._v(t._s(t.cols))]),t._v(" "),n("v-button",{on:{click:t.increaseColsCount}},[t._v("+")])],1),t._v(" "),n("label",{attrs:{for:""}},[t._v("Rows")]),t._v(" "),n("div",{staticClass:"table-control"},[n("v-button",{on:{click:t.decreaseRowsCount}},[t._v("-")]),t._v(" "),n("span",[t._v(t._s(t.rows))]),t._v(" "),n("v-button",{on:{click:t.increaseRowsCount}},[t._v("+")])],1),t._v(" "),n("label",{attrs:{for:""}},[t._v("Table head")]),t._v(" "),n("div",{staticClass:"table-control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.value.thead,expression:"value.thead"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.value.thead)?t._i(t.value.thead,null)>-1:t.value.thead},on:{change:function(e){var n=t.value.thead,a=e.target,r=!!a.checked;if(Array.isArray(n)){var o=t._i(n,null);a.checked?o<0&&t.$set(t.value,"thead",n.concat([null])):o>-1&&t.$set(t.value,"thead",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.value,"thead",r)}}})])])};u._withStripped=!0;const v=n({render:u,staticRenderFns:[]},(function(t){t&&t("data-v-a2f86986_0",{source:"\n.table-control[data-v-a2f86986] {\r\n\tdisplay: flex;\r\n\talign-items: stretch;\n}\n.table-control span[data-v-a2f86986] {\r\n\tflex: 1;\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-items: center;\n}\r\n",map:{version:3,sources:["/mnt/d/projects/@contentarchitect/table/src/settings.vue"],names:[],mappings:";AAgEA;CACA,aAAA;CACA,oBAAA;AACA;AAEA;CACA,OAAA;CACA,aAAA;CACA,uBAAA;CACA,mBAAA;AACA",file:"settings.vue",sourcesContent:['<template>\r\n\t<css-grid :columns="[\'2fr\', \'3fr\']" gap="8px 0">\r\n\t\t<label for="">Cols</label>\r\n\t\t<div class="table-control">\r\n\t\t\t<v-button @click="decreaseColsCount">-</v-button>\r\n\t\t\t<span>{{cols}}</span>\r\n\t\t\t<v-button @click="increaseColsCount">+</v-button>\r\n\t\t</div>\r\n\r\n\t\t<label for="">Rows</label>\r\n\t\t<div class="table-control">\r\n\t\t\t<v-button @click="decreaseRowsCount">-</v-button>\r\n\t\t\t<span>{{rows}}</span>\r\n\t\t\t<v-button @click="increaseRowsCount">+</v-button>\r\n\t\t</div>\r\n\r\n\t\t<label for="">Table head</label>\r\n\t\t<div class="table-control">\r\n\t\t\t<input type="checkbox" v-model="value.thead" />\r\n\t\t</div>\r\n\t</css-grid>\r\n</template>\r\n\r\n<script>\r\nimport { CssGrid, CaInput, Button } from "@contentarchitect/editor"\r\n\r\nexport default {\r\n\tcomponents: { CssGrid, CaInput, "v-button": Button },\r\n\tprops: [\'value\'],\r\n\tdata () {\r\n\t\treturn {\r\n\t\t\temptyCell: { value: "" }\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\trows () {\r\n\t\t\treturn this.value.data.length\r\n\t\t},\r\n\t\tcols () {\r\n\t\t\treturn this.value.data[0].length\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tincreaseColsCount () {\r\n\t\t\tthis.value.data.forEach((row, i) => {\r\n\t\t\t\trow.push({ ...this.emptyCell })\r\n\t\t\t});\r\n\t\t},\r\n\t\tdecreaseColsCount () {\r\n\t\t\tthis.value.data.forEach((row, i) => row.pop());\r\n\t\t},\r\n\t\tincreaseRowsCount () {\r\n\t\t\tconst row = Array(this.cols).fill().map(() => ({ ...this.emptyCell }))\r\n\t\t\trow.id = Math.random()\r\n\t\t\tthis.value.data.push(row)\r\n\t\t},\r\n\t\tdecreaseRowsCount () {\r\n\t\t\tthis.value.data.pop()\r\n\t\t},\r\n\t},\r\n}\r\n<\/script>\r\n\r\n<style scoped>\r\n.table-control {\r\n\tdisplay: flex;\r\n\talign-items: stretch;\r\n}\r\n\r\n.table-control span {\r\n\tflex: 1;\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n}\r\n</style>']},media:void 0})}),d,"data-v-a2f86986",false,undefined,!1,r,void 0,void 0);var h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 20H4v-4h4v4zm0-6H4v-4h4v4zm0-6H4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4z"}})])}};function p(t){const e=[];return Array.from(t).forEach(t=>{let n=[];Array.from(t.children).forEach(t=>n.push({value:t.innerHTML})),e.push(n)}),e}class Table extends t.Block{static get viewComponent(){return c}static get settingsComponent(){return v}static get icon(){return h}static defaultData(){return{caption:"",thead:!1,data:[[{value:""},{value:""}],[{value:""},{value:""}]]}}toHTML(){let t=this.thead&&[this.data[0]].reduce((t,e)=>t+"<tr>"+e.reduce((t,e)=>`${t}\n<th>${e.value}</th>`,"")+"</tr>",""),e=(this.thead?this.data.slice(1,this.data.length):this.data).reduce((t,e)=>t+"<tr>"+e.reduce((t,e)=>`${t}\n<td>${e.value}</td>`,"")+"</tr>","");return t?(t=`<thead>${t}</thead>`,e=`<tbody>${e}</tbody>`):t="",`<table>\n            <caption>${this.caption}</caption>\n            ${t}\n            ${e}\n        </table>`}static serializeFromHTML(t){const e=t.querySelector("table");if(!e)return this.defaultData();let n=e?e.caption:"";n&&(n=n.innerHTML);const a=[],r=!!e.tHead;return r&&a.push(p(e.tHead.children)[0]),Array.from(e.tBodies).forEach(t=>{a.push(...p(t.children))}),{caption:n,thead:r,data:a}}}return Table}));
